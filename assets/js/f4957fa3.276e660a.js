"use strict";(globalThis.webpackChunkkingtech_actions=globalThis.webpackChunkkingtech_actions||[]).push([[992],{8506(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"publish-docker/Example","title":"Example","description":"Basic Usage","source":"@site/docs/publish-docker/2_Example.md","sourceDirName":"publish-docker","slug":"/publish-docker/Example","permalink":"/publish-docker/Example","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/publish-docker/Overview"},"next":{"title":"Overview","permalink":"/publish-nuget/Overview"}}');var t=s(4848),r=s(8453);const a={sidebar_position:2},c="Example",o={},l=[{value:"Basic Usage",id:"basic-usage",level:2},{value:"With Multiple Tags",id:"with-multiple-tags",level:2},{value:"With Version from GitVersion",id:"with-version-from-gitversion",level:2},{value:"With Custom Dockerfile",id:"with-custom-dockerfile",level:2},{value:"With Branch-Specific Tags",id:"with-branch-specific-tags",level:2},{value:"Complete CI/CD Pipeline",id:"complete-cicd-pipeline",level:2},{value:"Setting Up Docker Hub Secrets",id:"setting-up-docker-hub-secrets",level:2},{value:"What Happens",id:"what-happens",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"example",children:"Example"})}),"\n",(0,t.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsx)(n.p,{children:"Here's a simple example that builds and publishes a Docker image to Docker Hub:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: Build and Push Docker Image\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  docker:\n    runs-on: ubuntu-latest\n    steps:\n    # Checkout repository\n    - uses: actions/checkout@v3\n\n    # Build and push Docker image\n    - name: Build and push to Docker Hub\n      uses: KingTech/KingTech.GithubActions/publish-docker@main\n      with:\n        registry_username: ${{ secrets.DOCKERHUB_USERNAME }}\n        registry_password: ${{ secrets.DOCKERHUB_TOKEN }}\n        image_name: "my-app"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This will create an image tagged as ",(0,t.jsx)(n.code,{children:"latest"})," by default."]}),"\n",(0,t.jsx)(n.h2,{id:"with-multiple-tags",children:"With Multiple Tags"}),"\n",(0,t.jsx)(n.p,{children:"Example pushing an image with multiple tags:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: Build and Push Docker Image\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  docker:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    - name: Build and push with multiple tags\n      uses: KingTech/KingTech.GithubActions/publish-docker@main\n      with:\n        registry_username: ${{ secrets.DOCKERHUB_USERNAME }}\n        registry_password: ${{ secrets.DOCKERHUB_TOKEN }}\n        image_name: "my-app"\n        tags: "latest;1.0.0;stable"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This will tag the image as ",(0,t.jsx)(n.code,{children:"latest"}),", ",(0,t.jsx)(n.code,{children:"1.0.0"}),", and ",(0,t.jsx)(n.code,{children:"stable"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"with-version-from-gitversion",children:"With Version from GitVersion"}),"\n",(0,t.jsx)(n.p,{children:"Example using a version number from GitVersion:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: Build and Push Versioned Docker Image\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  docker:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n      with:\n        fetch-depth: 0\n\n    # Get version number\n    - name: Get version\n      id: gitversion\n      uses: KingTech/KingTech.GithubActions/gitversion@main\n\n    # Build and push with version tag\n    - name: Build and push Docker image\n      uses: KingTech/KingTech.GithubActions/publish-docker@main\n      with:\n        registry_username: ${{ secrets.DOCKERHUB_USERNAME }}\n        registry_password: ${{ secrets.DOCKERHUB_TOKEN }}\n        image_name: "my-app"\n        tags: "latest;${{ steps.gitversion.outputs.version }}"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"with-custom-dockerfile",children:"With Custom Dockerfile"}),"\n",(0,t.jsx)(n.p,{children:"Example using a custom Dockerfile location:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: Build Custom Docker Image\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  docker:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    - name: Build from custom Dockerfile\n      uses: KingTech/KingTech.GithubActions/publish-docker@main\n      with:\n        registry_username: ${{ secrets.DOCKERHUB_USERNAME }}\n        registry_password: ${{ secrets.DOCKERHUB_TOKEN }}\n        image_name: "my-app"\n        docker_file: "docker/api.Dockerfile"\n        tags: "latest"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"with-branch-specific-tags",children:"With Branch-Specific Tags"}),"\n",(0,t.jsx)(n.p,{children:"Example creating different tags based on the branch:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: Build and Push Docker Image\n\non:\n  push:\n    branches: [ main, development, release/* ]\n\njobs:\n  docker:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n      with:\n        fetch-depth: 0\n\n    - name: Get version and branch\n      id: gitversion\n      uses: KingTech/KingTech.GithubActions/gitversion@main\n\n    - name: Build and push with branch tag\n      uses: KingTech/KingTech.GithubActions/publish-docker@main\n      with:\n        registry_username: ${{ secrets.DOCKERHUB_USERNAME }}\n        registry_password: ${{ secrets.DOCKERHUB_TOKEN }}\n        image_name: "my-app"\n        tags: "${{ steps.gitversion.outputs.branchTag }};${{ steps.gitversion.outputs.version }}"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This creates tags like ",(0,t.jsx)(n.code,{children:"alpha"}),", ",(0,t.jsx)(n.code,{children:"beta"}),", or ",(0,t.jsx)(n.code,{children:"main"})," along with the version number."]}),"\n",(0,t.jsx)(n.h2,{id:"complete-cicd-pipeline",children:"Complete CI/CD Pipeline"}),"\n",(0,t.jsx)(n.p,{children:"Example of a full pipeline: build, test, version, and deploy:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'name: Complete Docker Pipeline\n\non:\n  push:\n    branches: [ main ]\n\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n    # Checkout code\n    - uses: actions/checkout@v3\n      with:\n        fetch-depth: 0\n\n    # Build and test .NET application\n    - name: Build and Test\n      uses: KingTech/KingTech.GithubActions/dotnet-build-test@main\n\n    # Get version number\n    - name: Get version\n      id: gitversion\n      uses: KingTech/KingTech.GithubActions/gitversion@main\n\n    # Build and push Docker image\n    - name: Build and push Docker image\n      uses: KingTech/KingTech.GithubActions/publish-docker@main\n      with:\n        registry_username: ${{ secrets.DOCKERHUB_USERNAME }}\n        registry_password: ${{ secrets.DOCKERHUB_TOKEN }}\n        image_name: "my-app"\n        tags: "latest;${{ steps.gitversion.outputs.version }};${{ steps.gitversion.outputs.branchTag }}"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-docker-hub-secrets",children:"Setting Up Docker Hub Secrets"}),"\n",(0,t.jsx)(n.p,{children:"To use this action, you need to add Docker Hub credentials as GitHub secrets:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Go to your Docker Hub account and create an access token"}),"\n",(0,t.jsx)(n.li,{children:"In your GitHub repository, go to Settings \u2192 Secrets and variables \u2192 Actions"}),"\n",(0,t.jsxs)(n.li,{children:["Add two secrets:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"DOCKERHUB_USERNAME"}),": Your Docker Hub username"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"DOCKERHUB_TOKEN"}),": Your Docker Hub access token"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"what-happens",children:"What Happens"}),"\n",(0,t.jsx)(n.p,{children:"When this action runs, it will:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Log in to the Docker registry using provided credentials"}),"\n",(0,t.jsx)(n.li,{children:"Set up Docker Buildx for multi-platform builds"}),"\n",(0,t.jsx)(n.li,{children:"Build the Docker image for both AMD64 and ARM64 architectures"}),"\n",(0,t.jsx)(n.li,{children:"Tag the image with all specified tags"}),"\n",(0,t.jsx)(n.li,{children:"Push the image(s) to the Docker registry"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The resulting images will be available in your Docker Hub repository and can be pulled using ",(0,t.jsx)(n.code,{children:"docker pull <username>/<image_name>:<tag>"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>c});var i=s(6540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);