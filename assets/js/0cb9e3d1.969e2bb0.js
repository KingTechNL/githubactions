"use strict";(globalThis.webpackChunkkingtech_actions=globalThis.webpackChunkkingtech_actions||[]).push([[386],{3537(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>d,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"replace-env/Example","title":"Example","description":"Basic Usage - Single File","source":"@site/docs/replace-env/2_Example.md","sourceDirName":"replace-env","slug":"/replace-env/Example","permalink":"/replace-env/Example","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/replace-env/Overview"}}');var l=i(4848),a=i(8453);const c={sidebar_position:2},r="Example",t={},o=[{value:"Basic Usage - Single File",id:"basic-usage---single-file",level:2},{value:"Multiple Files",id:"multiple-files",level:2},{value:"Entire Directory (Recursive)",id:"entire-directory-recursive",level:2},{value:"With Different Placeholder Patterns",id:"with-different-placeholder-patterns",level:2},{value:"Single Dollar Brackets (Default)",id:"single-dollar-brackets-default",level:3},{value:"Double Dollar Brackets",id:"double-dollar-brackets",level:3},{value:"Double Underscore",id:"double-underscore",level:3},{value:"With Output File (Copy and Replace)",id:"with-output-file-copy-and-replace",level:2},{value:"With Fail on Missing Variables",id:"with-fail-on-missing-variables",level:2},{value:"Docusaurus Configuration Example",id:"docusaurus-configuration-example",level:2},{value:"Kubernetes Deployment Example",id:"kubernetes-deployment-example",level:2},{value:"With Secrets",id:"with-secrets",level:2},{value:"Common Use Cases",id:"common-use-cases",level:2},{value:"1. Environment-Specific Configuration",id:"1-environment-specific-configuration",level:3},{value:"2. Version Injection",id:"2-version-injection",level:3},{value:"3. Dynamic Docker Compose",id:"3-dynamic-docker-compose",level:3},{value:"Important Notes",id:"important-notes",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"example",children:"Example"})}),"\n",(0,l.jsx)(n.h2,{id:"basic-usage---single-file",children:"Basic Usage - Single File"}),"\n",(0,l.jsx)(n.p,{children:"Replace environment variables in a single configuration file:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'name: Deploy with Configuration\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  API_URL: "https://api.production.com"\n  APP_NAME: "MyApp"\n  VERSION: "1.2.3"\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Replace environment variables in config file\n    - name: Replace environment variables\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: \'./config/appsettings.json\'\n'})}),"\n",(0,l.jsxs)(n.p,{children:["If your ",(0,l.jsx)(n.code,{children:"appsettings.json"})," contains:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "ApiUrl": "${API_URL}",\n  "AppName": "${APP_NAME}",\n  "Version": "${VERSION}"\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"It will be transformed to:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "ApiUrl": "https://api.production.com",\n  "AppName": "MyApp",\n  "Version": "1.2.3"\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"multiple-files",children:"Multiple Files"}),"\n",(0,l.jsx)(n.p,{children:"Replace environment variables in multiple files at once:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'name: Configure Multiple Files\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  DATABASE_URL: "postgresql://localhost:5432/mydb"\n  REDIS_URL: "redis://localhost:6379"\n  API_KEY: ${{ secrets.API_KEY }}\n\njobs:\n  configure:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Replace variables in multiple files\n    - name: Replace environment variables\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: |\n          ./config/database.yml\n          ./config/redis.conf\n          ./config/api.config\n'})}),"\n",(0,l.jsx)(n.h2,{id:"entire-directory-recursive",children:"Entire Directory (Recursive)"}),"\n",(0,l.jsx)(n.p,{children:"Replace environment variables in all files within a directory:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'name: Configure Directory\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  ENVIRONMENT: "production"\n  SITE_URL: "https://mysite.com"\n\njobs:\n  configure:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Replace in all files in directory recursively\n    - name: Replace environment variables\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: \'./config\'\n'})}),"\n",(0,l.jsxs)(n.p,{children:["This will process all files in the ",(0,l.jsx)(n.code,{children:"config"})," directory and its subdirectories."]}),"\n",(0,l.jsx)(n.h2,{id:"with-different-placeholder-patterns",children:"With Different Placeholder Patterns"}),"\n",(0,l.jsx)(n.p,{children:"Example using different placeholder formats:"}),"\n",(0,l.jsx)(n.h3,{id:"single-dollar-brackets-default",children:"Single Dollar Brackets (Default)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Replace with ${VAR}\n  uses: KingTech/KingTech.GithubActions/replace-env@main\n  with:\n    input_file: './config.yml'\n    pattern: 'single_dollar_brackets'\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Replaces: ",(0,l.jsx)(n.code,{children:"${API_URL}"}),", ",(0,l.jsx)(n.code,{children:"${DATABASE_NAME}"}),", etc."]}),"\n",(0,l.jsx)(n.h3,{id:"double-dollar-brackets",children:"Double Dollar Brackets"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Replace with ${{VAR}}\n  uses: KingTech/KingTech.GithubActions/replace-env@main\n  with:\n    input_file: './config.yml'\n    pattern: 'double_dollar_brackets'\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Replaces: ",(0,l.jsx)(n.code,{children:"${{API_URL}}"}),", ",(0,l.jsx)(n.code,{children:"${{DATABASE_NAME}}"}),", etc."]}),"\n",(0,l.jsx)(n.h3,{id:"double-underscore",children:"Double Underscore"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Replace with __VAR__\n  uses: KingTech/KingTech.GithubActions/replace-env@main\n  with:\n    input_file: './config.yml'\n    pattern: 'double_underscore'\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Replaces: ",(0,l.jsx)(n.code,{children:"__API_URL__"}),", ",(0,l.jsx)(n.code,{children:"__DATABASE_NAME__"}),", etc."]}),"\n",(0,l.jsx)(n.h2,{id:"with-output-file-copy-and-replace",children:"With Output File (Copy and Replace)"}),"\n",(0,l.jsx)(n.p,{children:"Create a new file with replaced values instead of modifying the original:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Generate Configuration\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  API_URL: \"https://api.production.com\"\n\njobs:\n  generate:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Create new file with replaced values\n    - name: Generate configuration\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: './config/appsettings.template.json'\n        output_file: './config/appsettings.json'\n"})}),"\n",(0,l.jsx)(n.p,{children:"This keeps your template intact and creates a new configured file."}),"\n",(0,l.jsx)(n.h2,{id:"with-fail-on-missing-variables",children:"With Fail on Missing Variables"}),"\n",(0,l.jsx)(n.p,{children:"Ensure all required environment variables are present:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'name: Deploy with Validation\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  API_URL: "https://api.production.com"\n  DATABASE_URL: "postgresql://localhost/mydb"\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Fail if any environment variable is missing\n    - name: Replace and validate\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: \'./config/app.config\'\n        fail_on_missing_env: true\n'})}),"\n",(0,l.jsxs)(n.p,{children:["If your config file references ",(0,l.jsx)(n.code,{children:"${MISSING_VAR}"})," and it's not defined, the workflow will fail."]}),"\n",(0,l.jsx)(n.h2,{id:"docusaurus-configuration-example",children:"Docusaurus Configuration Example"}),"\n",(0,l.jsx)(n.p,{children:"Replace environment variables in Docusaurus configuration files:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'name: Build Docusaurus with Environment Variables\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  SITE_NAME: "My Documentation"\n  SITE_URL: "https://docs.mycompany.com"\n  BASE_URL: "/docs/"\n  PROJECT_NAME: "My Project"\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Replace environment variables in Docusaurus files\n    - name: Configure Docusaurus\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: |\n          ./docusaurus.config.js\n          ./sidebars.js\n          ./docs\n        pattern: \'single_dollar_brackets\'\n\n    # Build Docusaurus site with configured values\n    - name: Build documentation\n      uses: KingTech/KingTech.GithubActions/docusaurus-build@main\n      with:\n        siteName: ${{ env.SITE_NAME }}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Your ",(0,l.jsx)(n.code,{children:"docusaurus.config.js"})," might contain:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\n  title: '${SITE_NAME}',\n  url: '${SITE_URL}',\n  baseUrl: '${BASE_URL}',\n  projectName: '${PROJECT_NAME}',\n  // ... rest of config\n};\n"})}),"\n",(0,l.jsx)(n.h2,{id:"kubernetes-deployment-example",children:"Kubernetes Deployment Example"}),"\n",(0,l.jsx)(n.p,{children:"Replace environment variables in Kubernetes manifests:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'name: Deploy to Kubernetes\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  IMAGE_TAG: ${{ github.sha }}\n  NAMESPACE: "production"\n  REPLICAS: "3"\n  CPU_LIMIT: "500m"\n  MEMORY_LIMIT: "512Mi"\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    # Configure Kubernetes manifests\n    - name: Configure manifests\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: \'./k8s\'\n        fail_on_missing_env: true\n\n    # Apply to cluster\n    - name: Deploy to Kubernetes\n      run: kubectl apply -f ./k8s\n'})}),"\n",(0,l.jsx)(n.p,{children:"Your deployment manifest might contain:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: myapp\n  namespace: ${NAMESPACE}\nspec:\n  replicas: ${REPLICAS}\n  template:\n    spec:\n      containers:\n      - name: myapp\n        image: myregistry/myapp:${IMAGE_TAG}\n        resources:\n          limits:\n            cpu: ${CPU_LIMIT}\n            memory: ${MEMORY_LIMIT}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"with-secrets",children:"With Secrets"}),"\n",(0,l.jsx)(n.p,{children:"Use GitHub secrets for sensitive values:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Configure with Secrets\n\non:\n  push:\n    branches: [ main ]\n\nenv:\n  API_KEY: ${{ secrets.API_KEY }}\n  DATABASE_PASSWORD: ${{ secrets.DB_PASSWORD }}\n  ENCRYPTION_KEY: ${{ secrets.ENCRYPTION_KEY }}\n  PUBLIC_URL: \"https://mysite.com\"\n\njobs:\n  configure:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v3\n\n    - name: Replace secrets and variables\n      uses: KingTech/KingTech.GithubActions/replace-env@main\n      with:\n        input_file: './config/secrets.yml'\n        fail_on_missing_env: true\n"})}),"\n",(0,l.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,l.jsx)(n.h3,{id:"1-environment-specific-configuration",children:"1. Environment-Specific Configuration"}),"\n",(0,l.jsx)(n.p,{children:"Maintain one template, generate configs for different environments:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'# For production\nenv:\n  ENV: "production"\n  API_URL: "https://api.prod.com"\n\n# For staging\nenv:\n  ENV: "staging"\n  API_URL: "https://api.staging.com"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-version-injection",children:"2. Version Injection"}),"\n",(0,l.jsx)(n.p,{children:"Inject build version into configuration:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Get version\n  id: version\n  uses: KingTech/KingTech.GithubActions/gitversion@main\n\n- name: Update version in files\n  env:\n    VERSION: ${{ steps.version.outputs.version }}\n  uses: KingTech/KingTech.GithubActions/replace-env@main\n  with:\n    input_file: './src/version.ts'\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-dynamic-docker-compose",children:"3. Dynamic Docker Compose"}),"\n",(0,l.jsx)(n.p,{children:"Generate docker-compose files with environment-specific values:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'env:\n  DB_PORT: "5432"\n  REDIS_PORT: "6379"\n  APP_PORT: "8080"\n\nsteps:\n  - name: Configure docker-compose\n    uses: KingTech/KingTech.GithubActions/replace-env@main\n    with:\n      input_file: \'./docker-compose.template.yml\'\n      output_file: \'./docker-compose.yml\'\n'})}),"\n",(0,l.jsx)(n.h2,{id:"important-notes",children:"Important Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"No spaces around variable names:"})," Use ",(0,l.jsx)(n.code,{children:"${VAR}"}),", not ",(0,l.jsx)(n.code,{children:"${ VAR }"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Case sensitive:"})," ",(0,l.jsx)(n.code,{children:"${API_URL}"})," is different from ",(0,l.jsx)(n.code,{children:"${api_url}"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"In-place by default:"})," Original files are modified unless ",(0,l.jsx)(n.code,{children:"output_file"})," is specified"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Recursive:"})," Directory processing includes all subdirectories"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Multiline input:"})," Use the pipe ",(0,l.jsx)(n.code,{children:"|"})," syntax for multiple files/directories"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},8453(e,n,i){i.d(n,{R:()=>c,x:()=>r});var s=i(6540);const l={},a=s.createContext(l);function c(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);